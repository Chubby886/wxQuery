/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   4.0.5
 */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.ES6Promise=b()}(this,function(){"use strict";function a(a){return"function"==typeof a||"object"==typeof a&&null!==a}function b(a){return"function"==typeof a}function i(a){g=a}function j(a){h=a}function p(){return function(){return process.nextTick(v)}}function q(){return"undefined"!=typeof f?function(){f(v)}:t()}function r(){var a=0,b=new m(v),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function s(){var a=new MessageChannel;return a.port1.onmessage=v,function(){return a.port2.postMessage(0)}}function t(){var a=setTimeout;return function(){return a(v,1)}}function v(){var a,b,c;for(a=0;e>a;a+=2)b=u[a],c=u[a+1],b(c),u[a]=void 0,u[a+1]=void 0;e=0}function w(){var a,b;try{return a=require,b=a("vertx"),f=b.runOnLoop||b.runOnContext,q()}catch(c){return t()}}function y(a,b){var f,c=arguments,d=this,e=new this.constructor(B);return void 0===e[A]&&$(e),f=d._state,f?function(){var a=c[f-1];h(function(){return W(f,e,a,d._result)})}():R(d,e,a,b),e}function z(a){var c,b=this;return a&&"object"==typeof a&&a.constructor===b?a:(c=new b(B),N(c,a),c)}function B(){}function G(){return new TypeError("You cannot resolve a promise with itself")}function H(){return new TypeError("A promises callback cannot return that same promise.")}function I(a){try{return a.then}catch(b){return F.error=b,F}}function J(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function K(a,b,c){h(function(a){var d=!1,e=J(c,b,function(c){d||(d=!0,b!==c?N(a,c):P(a,c))},function(b){d||(d=!0,Q(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,Q(a,e))},a)}function L(a,b){b._state===D?P(a,b._result):b._state===E?Q(a,b._result):R(b,void 0,function(b){return N(a,b)},function(b){return Q(a,b)})}function M(a,c,d){c.constructor===a.constructor&&d===y&&c.constructor.resolve===z?L(a,c):d===F?Q(a,F.error):void 0===d?P(a,c):b(d)?K(a,c,d):P(a,c)}function N(b,c){b===c?Q(b,G()):a(c)?M(b,c,I(c)):P(b,c)}function O(a){a._onerror&&a._onerror(a._result),S(a)}function P(a,b){a._state===C&&(a._result=b,a._state=D,0!==a._subscribers.length&&h(S,a))}function Q(a,b){a._state===C&&(a._state=E,a._result=b,h(O,a))}function R(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+D]=c,e[f+E]=d,0===f&&a._state&&h(S,a)}function S(a){var d,e,f,g,b=a._subscribers,c=a._state;if(0!==b.length){for(d=void 0,e=void 0,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?W(c,d,e,f):e(f);a._subscribers.length=0}}function T(){this.error=null}function V(a,b){try{return a(b)}catch(c){return U.error=c,U}}function W(a,c,d,e){var f=b(d),g=void 0,h=void 0,i=void 0,j=void 0;if(f){if(g=V(d,e),g===U?(j=!0,h=g.error,g=null):i=!0,c===g)return Q(c,H()),void 0}else g=e,i=!0;c._state!==C||(f&&i?N(c,g):j?Q(c,h):a===D?P(c,g):a===E&&Q(c,g))}function X(a,b){try{b(function(b){N(a,b)},function(b){Q(a,b)})}catch(c){Q(a,c)}}function Z(){return Y++}function $(a){a[A]=Y++,a._state=void 0,a._result=void 0,a._subscribers=[]}function _(a,b){this._instanceConstructor=a,this.promise=new a(B),this.promise[A]||$(this.promise),d(b)?(this._input=b,this.length=b.length,this._remaining=b.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&P(this.promise,this._result))):Q(this.promise,ab())}function ab(){return new Error("Array Methods must be provided an Array")}function bb(a){return new _(this,a).promise}function cb(a){var b=this;return d(a)?new b(function(c,d){var f,e=a.length;for(f=0;e>f;f++)b.resolve(a[f]).then(c,d)}):new b(function(a,b){return b(new TypeError("You must pass an array to race."))})}function db(a){var b=this,c=new b(B);return Q(c,a),c}function eb(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function fb(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function gb(a){this[A]=Z(),this._result=this._state=void 0,this._subscribers=[],B!==a&&("function"!=typeof a&&eb(),this instanceof gb?X(this,a):fb())}var d,e,f,g,h,k,l,m,n,o,u,x,A,C,D,E,F,U,Y,c=void 0;return c=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},d=c,e=0,f=void 0,g=void 0,h=function(a,b){u[e]=a,u[e+1]=b,e+=2,2===e&&(g?g(v):x())},k="undefined"!=typeof window?window:void 0,l=k||{},m=l.MutationObserver||l.WebKitMutationObserver,n="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),o="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,u=new Array(1e3),x=void 0,x=n?p():m?r():o?s():void 0===k&&"function"==typeof require?w():t(),A=Math.random().toString(36).substring(16),C=void 0,D=1,E=2,F=new T,U=new T,Y=0,_.prototype._enumerate=function(){var c,a=this.length,b=this._input;for(c=0;this._state===C&&a>c;c++)this._eachEntry(b[c],c)},_.prototype._eachEntry=function(a,b){var e,f,c=this._instanceConstructor,d=c.resolve;d===z?(e=I(a),e===y&&a._state!==C?this._settledAt(a._state,b,a._result):"function"!=typeof e?(this._remaining--,this._result[b]=a):c===gb?(f=new c(B),M(f,a,e),this._willSettleAt(f,b)):this._willSettleAt(new c(function(b){return b(a)}),b)):this._willSettleAt(d(a),b)},_.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===C&&(this._remaining--,a===E?Q(d,c):this._result[b]=c),0===this._remaining&&P(d,this._result)},_.prototype._willSettleAt=function(a,b){var c=this;R(a,void 0,function(a){return c._settledAt(D,b,a)},function(a){return c._settledAt(E,b,a)})},gb.all=bb,gb.race=cb,gb.resolve=z,gb.reject=db,gb._setScheduler=i,gb._setAsap=j,gb._asap=h,gb.prototype={constructor:gb,then:y,"catch":function(a){return this.then(null,a)}},gb.Promise=gb,gb});